<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ìœ íŠœë¸Œ ì‡¼ì¸  ìë™ ìƒì„±ê¸°</title>
</head>
<body>
    <h1>ğŸ¬ ì‡¼ì¸  ìƒì„±ê¸°</h1>

    <form method="post">
        {% csrf_token %}
        {{ form.as_p }}
        
        <hr>

        <!-- ğŸ—£ï¸ í™”ìë³„ ìŒì„± ì„¤ì • -->
        <h3>ğŸ—£ï¸ í™”ìë³„ ìŒì„± ì„¤ì •</h3>
        <div style="display: flex; gap: 30px;">
            {% for speaker in "ABC" %}
            <div>
                <strong>{{ speaker }} í™”ì</strong><br>
                <label>ì–¸ì–´:
                    <select name="lang_{{ speaker }}">
                        <option value="ko">í•œêµ­ì–´</option>
                        <option value="en">ì˜ì–´</option>
                    </select>
                </label><br>
                <label>ì„±ë³„:
                    <select name="gender_{{ speaker }}">
                        <option value="female">ì—¬ì„±</option>
                        <option value="male">ë‚¨ì„±</option>
                    </select>
                </label>
            </div>
            {% endfor %}
        </div>

        <hr>
        
  

        <br>
        <button type="submit">ğŸ“½ï¸ ì˜ìƒ ë§Œë“¤ê¸°</button>
    </form>

    {% if video_path %}
        {% if tags %}
            <div>
                <h3>ğŸ”– ìë™ ìƒì„±ëœ íƒœê·¸</h3>
                <ul>
                {% for tag in tags %}
                    <li>#{{ tag }}</li>
                {% endfor %}
                </ul>
            </div>
        {% endif %}
        <h3>ğŸ¥ ì˜ìƒ ë¯¸ë¦¬ë³´ê¸°</h3>
        <video src="{{ video_path }}" controls style="width: 100%; max-width: 600px;"></video>
        
        <h3>ğŸ“œ ì˜ìƒ ì²« ëŒ“ê¸€ ì…ë ¥</h3>
        <textarea 
            name="comment_text" 
            placeholder="ì˜ìƒ ì²« ëŒ“ê¸€ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”"
        >ì´ ì˜ìƒê³¼ ê´€ë ¨ëœ ìì„¸í•œ ì„¤ëª…ì€ ë¸”ë¡œê·¸ì—ì„œ ë³´ì„¸ìš”! ğŸ‘‰ https://nicednjsdud.github.io/backend/Backend-cpu_scheduling_blog</textarea>

        <!-- âœ… ìœ íŠœë¸Œ ì—…ë¡œë“œ ë²„íŠ¼ -->
        <button id="uploadBtn">YouTubeì— ì—…ë¡œë“œ</button>
        <div id="uploadStatus"></div>

        <script>
            document.getElementById("uploadBtn").addEventListener("click", function () {
            fetch("{% url 'upload_to_youtube' %}", {
                method: "POST",
                headers: {
                "X-CSRFToken": "{{ csrf_token }}"
                }
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                document.getElementById("uploadBtn").disabled = true;
                document.getElementById("uploadStatus").innerHTML =
                    `<p>âœ… ì—…ë¡œë“œ ì™„ë£Œ! <a href="https://youtu.be/${data.video_id}" target="_blank">ì˜ìƒ ë³´ê¸°</a></p>`;
                } else {
                document.getElementById("uploadStatus").textContent = "âŒ ì—…ë¡œë“œ ì‹¤íŒ¨: " + data.error;
                }
            });
            });
        </script>
    {% endif %}
</body>
</html>